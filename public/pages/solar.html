<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Solar System Explorer</title>
  <style>
    :root{
      --bg:#0b0f14;         /* deep space */
      --bg-soft:#0f1620;    /* panels */
      --ink:#c9d5ff;        /* text */
      --muted:#7f8dab;      /* secondary text */
      --accent:#7aa2ff;     /* links/accents */
      --accent-2:#33e1a2;   /* highlight */
      --warn:#ffd166;
      --shadow: 0 10px 30px rgba(0,0,0,.35);
    }
    html,body { height:100%; background: radial-gradient(1200px 800px at 70% 20%, #0d1522 0%, var(--bg) 60%); margin:0; font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji"; color:var(--ink); overflow:hidden; }
    #app { position:fixed; inset:0; display:grid; grid-template-rows:auto 1fr; }

    /* Title Bar */
    header { display:flex; align-items:center; gap:.9rem; padding:.8rem 1rem; background:linear-gradient(180deg, rgba(14,20,30,.9), rgba(14,20,30,.7)); backdrop-filter: blur(6px); border-bottom:1px solid rgba(255,255,255,.06); z-index:5; }
    .logo { width:28px; height:28px; border-radius:50%; background: radial-gradient(circle at 35% 35%, #ffef99, #ffaf34 40%, #f2682a 60%, #9b3b00 100%); box-shadow:0 0 30px #fdb54a, 0 0 80px rgba(255,200,100,.6) inset; }
    h1 { font-size:1.05rem; letter-spacing:.08em; margin:0; text-transform:uppercase; color:#e9f0ff; }
    .spacer { flex:1; }

    /* Controls */
    .panel { position:fixed; top:64px; left:16px; width:290px; background:linear-gradient(180deg, rgba(16,24,36,.9), rgba(16,24,36,.7)); border:1px solid rgba(255,255,255,.06); border-radius:16px; box-shadow: var(--shadow); padding:12px 14px; z-index:5; }
    .panel h2 { margin:2px 0 8px; font-size:.95rem; font-weight:600; color:#e7ecff; display:flex; align-items:center; gap:.5rem; }
    .panel h2 .dot { width:8px; height:8px; border-radius:50%; background:var(--accent-2); box-shadow:0 0 10px var(--accent-2); }
    .row { display:flex; align-items:center; gap:.6rem; margin:8px 0; }
    label { font-size:.82rem; color:var(--muted); }
    input[type="range"] { flex:1; appearance:none; height:6px; background:#1a2636; border-radius:999px; outline:none; }
    input[type="range"]::-webkit-slider-thumb { -webkit-appearance:none; width:16px; height:16px; border-radius:50%; background:var(--accent); box-shadow:0 0 12px var(--accent); border:2px solid #cfe0ff; }
    .btns { display:flex; gap:.5rem; }
    .btn { cursor:pointer; background:#111a28; border:1px solid rgba(255,255,255,.08); color:#d7e2ff; padding:.45rem .7rem; border-radius:12px; font-size:.85rem; transition: transform .05s ease, background .2s ease; }
    .btn:active { transform: translateY(1px) scale(.98); }
    .btn:hover { background:#152236; }
    .muted { color:var(--muted); font-size:.78rem; line-height:1.35; }

    /* Canvas */
    canvas { position:absolute; inset:0; width:100%; height:100%; display:block; }

    /* Planet Tooltip / Info */
    .info { position:fixed; right:16px; top:64px; width:320px; max-width:calc(100vw - 32px); background:linear-gradient(180deg, rgba(16,24,36,.92), rgba(16,24,36,.78)); border:1px solid rgba(255,255,255,.06); border-radius:16px; box-shadow: var(--shadow); padding:12px 14px; z-index:5; opacity:0; transform: translateY(-6px); pointer-events:none; transition:opacity .18s ease, transform .18s ease; }
    .info.visible { opacity:1; transform: translateY(0); pointer-events:auto; }
    .info h3 { margin:0 0 8px; font-size:1.05rem; }
    .badge { display:inline-block; padding:.15rem .45rem; border-radius:999px; font-size:.72rem; background:#12233c; border:1px solid rgba(255,255,255,.08); color:#cfe0ff; }
    .kv { display:grid; grid-template-columns: 1fr auto; gap:.35rem .6rem; font-size:.9rem; }
    .kv div:nth-child(odd){ color:var(--muted); }
    .close { position:absolute; top:8px; right:8px; width:28px; height:28px; border-radius:10px; border:1px solid rgba(255,255,255,.08); background:#0f1a2a; color:#cfe0ff; cursor:pointer; }

    /* Footer hints */
    footer { position:fixed; bottom:10px; left:50%; transform:translateX(-50%); color:var(--muted); font-size:.82rem; background:rgba(10,16,24,.55); border:1px solid rgba(255,255,255,.06); border-radius:999px; padding:.4rem .8rem; z-index:5; backdrop-filter: blur(6px); }
    kbd { background:#0d1728; border:1px solid rgba(255,255,255,.12); border-bottom-color:rgba(0,0,0,.35); border-radius:6px; padding:.05rem .35rem; font-size:.78rem; color:#e3edff; }

    /* Responsive tweaks */
    @media (max-width: 760px){
      .panel { width: calc(100vw - 32px); left: 16px; right: 16px; top: 56px; }
      .info { right:16px; top: calc(56px + 148px + 10px); width: calc(100vw - 32px); }
      header { padding:.6rem .8rem; }
    }
  </style>
</head>
<body>
  <div id="app">
    <header>
      <div class="logo" aria-hidden="true"></div>
      <h1>Solar System Explorer</h1>
      <div class="spacer"></div>
      <div class="muted">Drag to rotate • Scroll to zoom • Click planets</div>
    </header>

    <canvas id="space" aria-label="3D view of the solar system" role="img"></canvas>

    <section class="panel" aria-label="Controls">
      <h2><span class="dot"></span> Controls</h2>
      <div class="row">
        <label for="speed">Orbit speed</label>
        <input id="speed" type="range" min="0" max="3" step="0.01" value="1" aria-valuemin="0" aria-valuemax="3" aria-valuenow="1" />
        <span class="badge" id="speedLabel">1.00×</span>
      </div>
      <div class="row btns">
        <button class="btn" id="zoomIn" aria-label="Zoom in">＋</button>
        <button class="btn" id="zoomOut" aria-label="Zoom out">－</button>
        <button class="btn" id="resetView" aria-label="Reset view">Reset</button>
      </div>
      <div class="muted" style="margin-top:8px">
        Tip: Click a planet to learn more. You can also use <kbd>W</kbd><kbd>A</kbd><kbd>S</kbd><kbd>D</kbd> to pan slightly.
      </div>
    </section>

    <aside class="info" id="info" aria-live="polite" aria-atomic="true">
      <button class="close" id="closeInfo" aria-label="Close">✕</button>
      <h3 id="infoTitle">Planet</h3>
      <div class="row" style="justify-content:space-between;align-items:center;margin:6px 0 10px">
        <span class="badge" id="infoType">Terrestrial</span>
        <span class="badge" id="infoYear">Year: — days</span>
      </div>
      <div class="kv">
        <div>Mean radius</div><div id="infoRadius">— km</div>
        <div>Distance from Sun</div><div id="infoDistance">— AU</div>
        <div>Moons</div><div id="infoMoons">—</div>
      </div>
    </aside>

    <footer>
      Drag to rotate • Scroll / buttons to zoom • Click planets for info
    </footer>
  </div>

  <script>
  // ---------- Data ----------
  const PLANETS = [
    { name:'Mercury', color:'#bfb8aa', radius_km:2440, au:0.39, year_days:88, moons:0, type:'Terrestrial' },
    { name:'Venus',   color:'#e0c08f', radius_km:6052, au:0.72, year_days:225, moons:0, type:'Terrestrial' },
    { name:'Earth',   color:'#6bb6ff', radius_km:6371, au:1.00, year_days:365, moons:1, type:'Terrestrial' },
    { name:'Mars',    color:'#d87052', radius_km:3390, au:1.52, year_days:687, moons:2, type:'Terrestrial' },
    { name:'Jupiter', color:'#d6b28a', radius_km:69911, au:5.20, year_days:4333, moons:95, type:'Gas Giant' },
    { name:'Saturn',  color:'#e6d09c', radius_km:58232, au:9.58, year_days:10759, moons:146, type:'Gas Giant' },
    { name:'Uranus',  color:'#77d7df', radius_km:25362, au:19.20, year_days:30687, moons:27, type:'Ice Giant' },
    { name:'Neptune', color:'#5a7cff', radius_km:24622, au:30.05, year_days:60190, moons:14, type:'Ice Giant' },
  ];

  // Scale helpers to keep things readable
  const sizeScale = (km)=> Math.pow(km, 0.35) * 0.9; // compress giant sizes
  const distScale = (au)=> Math.pow(au, 0.75) * 120;  // compress large distances

  // ---------- Canvas & Scene ----------
  const canvas = document.getElementById('space');
  const ctx = canvas.getContext('2d');
  const DPR = Math.min(2, window.devicePixelRatio || 1);
  let W = 0, H = 0, CX = 0, CY = 0;

  function resize(){
    W = canvas.width = Math.floor(innerWidth * DPR);
    H = canvas.height = Math.floor(innerHeight * DPR);
    canvas.style.width = innerWidth + 'px';
    canvas.style.height = innerHeight + 'px';
    CX = W/2; CY = H/2;
  }
  addEventListener('resize', resize);
  resize();

  // Camera parameters
  let camDist = 520;     // zoom (bigger = further)
  let yaw = 0.9;         // horizontal rotation
  let pitch = 0.28;      // vertical rotation
  let panX = 0, panY = 0; // subtle panning

  // Interaction state
  let dragging = false;  let lastX=0, lastY=0;
  let speedMultiplier = 1.0;

  // Planet runtime state
  const bodies = PLANETS.map(p=>({
    ...p,
    r: sizeScale(p.radius_km),
    d: distScale(p.au),
    theta: Math.random()*Math.PI*2 // random starting angle
  }));

  // Starfield
  const stars = new Array(600).fill(0).map(()=>({
    x: (Math.random()*2-1),
    y: (Math.random()*2-1),
    z: (Math.random()*0.8+0.2)
  }));

  // ---------- Math helpers ----------
  const clamp = (v,a,b)=> Math.max(a, Math.min(b,v));

  function project(point){
    // Apply camera rotation (yaw, then pitch), then perspective divide
    let {x,y,z} = point;
    // yaw around Y
    let cosY = Math.cos(yaw), sinY = Math.sin(yaw);
    let xz = x*cosY - z*sinY;
    let zz = x*sinY + z*cosY;
    // pitch around X
    let cosP = Math.cos(pitch), sinP = Math.sin(pitch);
    let yp = y*cosP - zz*sinP;
    let zp = y*sinP + zz*cosP + camDist; // translate camera back

    const f = 600 / (zp||1); // focal length
    return {
      sx: CX + (xz * f) + panX,
      sy: CY + (yp * f) + panY,
      depth: zp,
      scale: f
    };
  }

  // ---------- Input ----------
  canvas.addEventListener('mousedown', (e)=>{ dragging = true; lastX=e.clientX; lastY=e.clientY; });
  addEventListener('mouseup', ()=> dragging=false);
  addEventListener('mousemove', (e)=>{
    if(!dragging) return;
    const dx = (e.clientX - lastX); const dy = (e.clientY - lastY);
    yaw -= dx * 0.005; // invert for natural feel
    pitch = clamp(pitch - dy * 0.003, -1.2, 1.2);
    lastX = e.clientX; lastY = e.clientY;
  });
  canvas.addEventListener('wheel', (e)=>{
    e.preventDefault();
    camDist = clamp(camDist + Math.sign(e.deltaY)*24, 220, 1600);
  }, {passive:false});

  // Touch (1-finger rotate)
  canvas.addEventListener('touchstart', (e)=>{ if(e.touches.length===1){ dragging=true; lastX=e.touches[0].clientX; lastY=e.touches[0].clientY; } });
  canvas.addEventListener('touchmove', (e)=>{
    if(!dragging||e.touches.length!==1) return; const t=e.touches[0];
    const dx = (t.clientX - lastX), dy=(t.clientY - lastY);
    yaw -= dx * 0.005; pitch = clamp(pitch - dy * 0.003, -1.2, 1.2);
    lastX=t.clientX; lastY=t.clientY; e.preventDefault();
  }, {passive:false});
  addEventListener('touchend', ()=> dragging=false);

  // Buttons & slider
  const speed = document.getElementById('speed');
  const speedLabel = document.getElementById('speedLabel');
  speed.addEventListener('input', ()=>{ speedMultiplier = parseFloat(speed.value); speedLabel.textContent = speedMultiplier.toFixed(2)+'×'; });
  document.getElementById('zoomIn').onclick = ()=> camDist = clamp(camDist - 50, 220, 1600);
  document.getElementById('zoomOut').onclick = ()=> camDist = clamp(camDist + 50, 220, 1600);
  document.getElementById('resetView').onclick = ()=>{ camDist=520; yaw=0.9; pitch=0.28; panX=0; panY=0; };

  // WASD slight pan
  addEventListener('keydown', (e)=>{
    const k = e.key.toLowerCase();
    if(k==='a') panX += 12; else if(k==='d') panX -= 12;
    else if(k==='w') panY += 12; else if(k==='s') panY -= 12;
  });

  // ---------- Picking & Info ----------
  const info = {
    el: document.getElementById('info'),
    title: document.getElementById('infoTitle'),
    type: document.getElementById('infoType'),
    year: document.getElementById('infoYear'),
    radius: document.getElementById('infoRadius'),
    distance: document.getElementById('infoDistance'),
    moons: document.getElementById('infoMoons')
  };
  document.getElementById('closeInfo').onclick = ()=> info.el.classList.remove('visible');

  let lastProjected = []; // array of {name, x, y, pxRadius}

  function onClick(evt){
    const rect = canvas.getBoundingClientRect();
    const mx = (evt.clientX - rect.left) * DPR; const my = (evt.clientY - rect.top) * DPR;
    // search nearest hit within radius
    let best = null, bestDist = 1e9;
    for(const p of lastProjected){
      const dx = mx - p.x, dy = my - p.y; const dd = Math.hypot(dx,dy);
      const threshold = Math.max(6, p.pxRadius+4);
      if(dd <= threshold && dd < bestDist){ best = p; bestDist = dd; }
    }
    if(best){
      const planet = PLANETS.find(pl=>pl.name===best.name);
      info.title.textContent = planet.name;
      info.type.textContent = planet.type;
      info.year.textContent = `Year: ${planet.year_days.toLocaleString()} days`;
      info.radius.textContent = `${planet.radius_km.toLocaleString()} km`;
      info.distance.textContent = `${planet.au} AU`;
      info.moons.textContent = `${planet.moons}`;
      info.el.classList.add('visible');
    }
  }
  canvas.addEventListener('click', onClick);

  // ---------- Render Loop ----------
  let lastTime = performance.now();

  function drawStars(){
    for(const s of stars){
      // project a far star box around origin
      const P = project({x:s.x*2000, y:s.y*1200, z:-1000*s.z});
      const alpha = 0.5 + 0.5*(1-s.z);
      ctx.fillStyle = `rgba(180,200,255,${alpha.toFixed(2)})`;
      ctx.fillRect(P.sx, P.sy, 1.2, 1.2);
    }
  }

  function drawRings(){
    // draw orbital rings as faint ellipses (projected circles in world XY plane)
    ctx.save();
    // sample ellipse points per ring
    bodies.forEach(b=>{
      const steps = 120;
      ctx.beginPath();
      let started=false;
      for(let i=0;i<=steps;i++){
        const t = i/steps*Math.PI*2;
        const x = Math.cos(t)*b.d; const y=0; const z=Math.sin(t)*b.d;
        const P = project({x,y,z});
        if(!started){ ctx.moveTo(P.sx, P.sy); started=true; }
        else ctx.lineTo(P.sx, P.sy);
      }
      ctx.strokeStyle = 'rgba(130,160,210,0.08)';
      ctx.lineWidth = 1;
      ctx.stroke();
    });
    ctx.restore();
  }

  function drawSun(){
    const P = project({x:0,y:0,z:0});
    const r = 22 * P.scale; // scale with perspective for subtle parallax
    const grd = ctx.createRadialGradient(P.sx, P.sy, r*0.2, P.sx, P.sy, r);
    grd.addColorStop(0, '#fff5c5');
    grd.addColorStop(0.5, '#ffcc66');
    grd.addColorStop(1, 'rgba(255,160,40,0.1)');
    ctx.beginPath(); ctx.fillStyle = grd; ctx.arc(P.sx, P.sy, r, 0, Math.PI*2); ctx.fill();
    ctx.shadowColor = 'rgba(255,200,120,0.55)';
    ctx.shadowBlur = 30; ctx.beginPath(); ctx.arc(P.sx, P.sy, r*0.45, 0, Math.PI*2); ctx.fillStyle='#ffd27a'; ctx.fill();
    ctx.shadowBlur = 0;
  }

  function drawPlanets(dt){
    lastProjected = [];
    // sort by depth so far ones render first
    const sorted = [...bodies].sort((a,b)=>{
      const Pa = project({x:Math.cos(a.theta)*a.d, y:0, z:Math.sin(a.theta)*a.d});
      const Pb = project({x:Math.cos(b.theta)*b.d, y:0, z:Math.sin(b.theta)*b.d});
      return Pb.depth - Pa.depth;
    });

    for(const b of sorted){
      // Update orbit angle
      const omega = (1/ (b.year_days)) * (dt * 0.001) * 6.0 * speedMultiplier; // base factor tuned for visual speed
      b.theta += omega;

      // 3D position in ecliptic plane (y=0)
      const x = Math.cos(b.theta) * b.d;
      const y = 0;
      const z = Math.sin(b.theta) * b.d;
      const P = project({x,y,z});
      const pxR = Math.max(2, b.r * P.scale * 0.04); // scaled radius in pixels

      // drop-off lighting (simple Lambert vs sun)
      const toSun = {x:-x, y:-y, z:-z};
      const len = Math.hypot(toSun.x,toSun.y,toSun.z)||1; toSun.x/=len; toSun.y/=len; toSun.z/=len;
      const n = {x:0,y:0,z:1}; // fake normal
      const light = clamp(0.6 + 0.4*(toSun.x*n.x+toSun.y*n.y+toSun.z*n.z), 0, 1);

      // Planet disk
      ctx.beginPath();
      const grad = ctx.createRadialGradient(P.sx - pxR*0.4, P.sy - pxR*0.4, pxR*0.1, P.sx, P.sy, pxR);
      grad.addColorStop(0, shade(b.color, 1.1*light));
      grad.addColorStop(1, shade(b.color, 0.5));
      ctx.fillStyle = grad;
      ctx.arc(P.sx, P.sy, pxR, 0, Math.PI*2);
      ctx.fill();

      // Thin atmospheric rim
      ctx.beginPath();
      ctx.strokeStyle = hexToRgba(b.color, 0.35);
      ctx.lineWidth = 1 * DPR;
      ctx.arc(P.sx, P.sy, pxR+0.5, 0, Math.PI*2);
      ctx.stroke();

      // Saturn ring hint
      if(b.name==='Saturn'){
        ctx.save();
        ctx.translate(P.sx, P.sy);
        ctx.rotate(-yaw*0.6);
        ctx.scale(1, Math.cos(pitch));
        ctx.beginPath();
        ctx.ellipse(0,0, pxR*1.8, pxR*0.8, 0, 0, Math.PI*2);
        ctx.strokeStyle = 'rgba(230,210,160,0.45)';
        ctx.lineWidth = 1.2 * DPR;
        ctx.stroke();
        ctx.restore();
      }

      // Collect for picking
      lastProjected.push({ name:b.name, x:P.sx, y:P.sy, pxRadius:pxR });
    }
  }

  function shade(hex, factor){
    const {r,g,b} = hexToRgb(hex);
    return `rgb(${Math.round(r*factor)},${Math.round(g*factor)},${Math.round(b*factor)})`;
  }
  function hexToRgb(hex){
    const s = hex.replace('#','');
    const num = parseInt(s.length===3 ? s.split('').map(c=>c+c).join('') : s, 16);
    return { r:(num>>16)&255, g:(num>>8)&255, b:num&255 };
  }
  function hexToRgba(hex,a){ const {r,g,b}=hexToRgb(hex); return `rgba(${r},${g},${b},${a})`; }

  function frame(now){
    const dt = now - lastTime; lastTime = now;

    // Clear with subtle vignette
    ctx.clearRect(0,0,W,H);
    const grad = ctx.createRadialGradient(CX, CY, Math.min(W,H)*0.1, CX, CY, Math.max(W,H)*0.8);
    grad.addColorStop(0, 'rgba(8,13,20,0.0)');
    grad.addColorStop(1, 'rgba(4,6,10,0.55)');
    ctx.fillStyle = grad; ctx.fillRect(0,0,W,H);

    drawStars();
    drawRings();
    drawSun();
    drawPlanets(dt);

    requestAnimationFrame(frame);
  }
  requestAnimationFrame(frame);
  </script>
</body>
</html>
